namespace SpriteKind {
    export const EnemyProjectile = SpriteKind.create()
}

class PlayerShip {
    dmg: number;
    hp: number;
    spd: number;
    frt: number;
    constructor(dmg: number, hp: number, spd: number, frt: number){
        this.dmg = dmg;
        this.hp = hp;
        this.spd = spd;
        this.frt = frt;
    }
}

class EnemyShip {
    dmg: number;
    hp: number;
    spd: number;
    frt: number;
    constructor(dmg: number, hp: number, spd: number, frt: number) {
        this.dmg = dmg;
        this.hp = hp;
        this.spd = spd;
        this.frt = frt;
    }
}

const shipStats = [
    new PlayerShip(7, 5, 4, 4),
    new PlayerShip(2, 4, 5, 7),
    new PlayerShip(7, 4, 7, 3),
    new PlayerShip(5, 7, 4, 4)
]

const enemyStats = [
    new EnemyShip(1, 4, 4, .75),
    new EnemyShip(1, 7, 3, .4),
    new EnemyShip(1, 5, 3.5, .85)
]

const classSelectFrames = [
img`
dddddddddddddddddddddddddddddddddddd......................................................................................................................
dffffffffffffffffffffffffffffffffffd...555555555555555555555555555555555555....555555555555555555555555555555555555...555555555555555555555555555555555555
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffddddddddddddddddddddddddddffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffdffffffffffffffffffffffffdffffd...5ffff55555555555555555555555555ffff5....5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5
dffffdffffffffffffffffffffffffdffffd...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
dffffdffff55ffffffffffffffffffdffffd...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
dffffdfff5669fffffffffffffffffdffffd...5ffff5ffffffff5555555fffffffff5ffff5....5ffff5ff55ffffffffffffffffffff5ffff5...5ffff5ffffffffffff5555ffffffff5ffff5
dffffdfff54469ffffffffffffffffdffffd...5ffff5fffffff5444469ffffffffff5ffff5....5ffff5ff565fffffffffffffffffff5ffff5...5ffff5fffffffffff5669fffffffff5ffff5
dffffdff5444469fffffffffffffffdffffd...5ffff5ffffff5444469fffffffffff5ffff5....5ffff5ff56699fffffffffffffffff5ffff5...5ffff5ffffffffff54469fffffffff5ffff5
dffffdff55544469ffffffffffffffdffffd...5ffff5ffffff544469ffffffffffff5ffff5....5ffff5ff9446699fffffffffffffff5ffff5...5ffff5fffffffff54469ffffffffff5ffff5
dffffdff966544469fffffffffffffdffffd...5ffff5fffff5444469ffffffffffff5ffff5....5ffff5fff9444669ffffffffffffff5ffff5...5ffff5ffff55ff554469ffffffffff5ffff5
dffffdff9946544465fff999ffffffdffffd...5ffff5ffff54444469ffffffffffff5ffff5....5ffff5ffff9444469fffffffffffff5ffff5...5ffff5fff59ff55444465fffffffff5ffff5
dffffdff9944654445ffffaa9fffffdffffd...5ffff5ffff566664469ff999ffffff5ffff5....5ffff5fffff9444465fff9999fffff5ffff5...5ffff5ff549ff544444465ffffffff5ffff5
dffffdff9444465555f55577755fffdffffd...5ffff5fff95555566469ffaa9fffff5ffff5....5ffff5fffff55444555fffaaa9ffff5ffff5...5ffff5ff546555444444655555ffff5ffff5
dffffdff44444444445447888765ffdffffd...5ffff5fff954444556655577755fff5ffff5....5ffff5fffff5455566655777755fff5ffff5...5ffff5ff5466665555555667775fff5ffff5
dffffdff44444444445447888765ffdffffd...5ffff5ff95444444454447888765ff5ffff5....5ffff5ffff954444444478888765ff5ffff5...5ffff5ff55555554444444788875ff5ffff5
dffffdff9444465555f55577755fffdffffd...5ffff5ff95444444454447888765ff5ffff5....5ffff5ffff954444444478888765ff5ffff5...5ffff5ff55555554444444788875ff5ffff5
dffffdff9944654445ffffaa9fffffdffffd...5ffff5fff954444554655577755fff5ffff5....5ffff5fffff5455566655777755fff5ffff5...5ffff5ff5466665555555667775fff5ffff5
dffffdff9966544465fff999ffffffdffffd...5ffff5fff95555566469ffaa9fffff5ffff5....5ffff5fffff55444555fffaaa9ffff5ffff5...5ffff5ff546555444444655555ffff5ffff5
dffffdff965544469fffffffffffffdffffd...5ffff5ffff566664469ff999ffffff5ffff5....5ffff5fffff9444465fff9999fffff5ffff5...5ffff5ff549ff544444465ffffffff5ffff5
dffffdff55444469ffffffffffffffdffffd...5ffff5ffff54444469ffffffffffff5ffff5....5ffff5ffff9444469fffffffffffff5ffff5...5ffff5fff59ff55444465fffffffff5ffff5
dffffdff5444469fffffffffffffffdffffd...5ffff5fffff5444469ffffffffffff5ffff5....5ffff5fff9444669ffffffffffffff5ffff5...5ffff5ffff55ff554469ffffffffff5ffff5
dffffdfff54469ffffffffffffffffdffffd...5ffff5ffffff544469ffffffffffff5ffff5....5ffff5ff9446699fffffffffffffff5ffff5...5ffff5fffffffff54469ffffffffff5ffff5
dffffdfff5669fffffffffffffffffdffffd...5ffff5ffffff5444469fffffffffff5ffff5....5ffff5ff56699fffffffffffffffff5ffff5...5ffff5ffffffffff54469fffffffff5ffff5
dffffdffff55ffffffffffffffffffdffffd...5ffff5fffffff5444469ffffffffff5ffff5....5ffff5ff565fffffffffffffffffff5ffff5...5ffff5fffffffffff5669fffffffff5ffff5
dffffdffffffffffffffffffffffffdffffd...5ffff5ffffffff5555555fffffffff5ffff5....5ffff5ff55ffffffffffffffffffff5ffff5...5ffff5ffffffffffff5555ffffffff5ffff5
dffffdffffffffffffffffffffffffdffffd...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
dffffddddddddddddddddddddddddddffffd...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
dffffffffffffffffffffffffffffffffffd...5ffff55555555555555555555555555ffff5....5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dfddddfdddddfddddfdfdffdfddddfddddfd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dfdffffffdfffdffdfdfdffdfdffffdffdfd...5ffffff555ff5ffff5f55555f555fffffff5....5ff5555f5555f5ffff5555f5555f5ff5fff5...5fffffff5555f5ff5f5555f5555ffffffff5
dfddddfffdfffddddfdfdddffdddffddddfd...5ffffff5ff5f5ffff5fff5fffff5fffffff5....5ff5ffff5ff5f5ffff5ffff5ff5f55f5fff5...5ffffffffff5f5ff5f5ffff5fffffffffff5
dffffdfffdfffdfdffdfdffdfdffffdfdffd...5ffffff555ff5ffff5fff5ffff5ffffffff5....5ff555ff5555f5ffff5ffff5ff5f5f55fff5...5ffffffffff5f5ff5f5f55f5f55ffffffff5
dfddddfffdfffdfddfdfdffdfddddfdfddfd...5ffffff5ff5f5ffff5fff5fff5fffffffff5....5ff5ffff5ff5f5ffff5ffff5ff5f5ff5fff5...5fffffff5ff5f5ff5f5ff5f5ff5ffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffff555ff5555f5fff5fff555fffffff5....5ff5ffff5ff5f5555f5555f5555f5ff5fff5...5fffffff5555f5555f5555f5555ffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dfffffffffffdddffdfffdfddddffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffdffdffdfddfddfdfffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dfffffffdddfdffdfdfdfdfdfddffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffdffdffdfdfffdfdffdffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dfffffffffffdddffdfffdfddddffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffff2222f2222f222fffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffff2ffff2ff2f2ff2ffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffff222f2222f2222f2ff2ffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dfffffffffffffff2f2ffff2ff2ffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffff2222f2ffff222fffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
dddddddddddddddddddddddddddddddddddd...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
.......................................555555555555555555555555555555555555....555555555555555555555555555555555555...555555555555555555555555555555555555
`,
img`
.......................................dddddddddddddddddddddddddddddddddddd...............................................................................
555555555555555555555555555555555555...dffffffffffffffffffffffffffffffffffd....555555555555555555555555555555555555...555555555555555555555555555555555555
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffddddddddddddddddddddddddddffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffff55555555555555555555555555ffff5...dffffdffffffffffffffffffffffffdffffd....5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5
5ffff5ffffffffffffffffffffffff5ffff5...dffffdffffffffffffffffffffffffdffffd....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
5ffff5ffffffffffffffffffffffff5ffff5...dffffdffffffff5555555fffffffffdffffd....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
5ffff5ffff55ffffffffffffffffff5ffff5...dffffdfffffff5444469ffffffffffdffffd....5ffff5ff55ffffffffffffffffffff5ffff5...5ffff5ffffffffffff5555ffffffff5ffff5
5ffff5fff5669fffffffffffffffff5ffff5...dffffdffffff5444469fffffffffffdffffd....5ffff5ff565fffffffffffffffffff5ffff5...5ffff5fffffffffff5669fffffffff5ffff5
5ffff5fff54469ffffffffffffffff5ffff5...dffffdffffff544469ffffffffffffdffffd....5ffff5ff56699fffffffffffffffff5ffff5...5ffff5ffffffffff54469fffffffff5ffff5
5ffff5ff5444469fffffffffffffff5ffff5...dffffdfffff5444469ffffffffffffdffffd....5ffff5ff9446699fffffffffffffff5ffff5...5ffff5fffffffff54469ffffffffff5ffff5
5ffff5ff55544469ffffffffffffff5ffff5...dffffdffff54444469ffffffffffffdffffd....5ffff5fff9444669ffffffffffffff5ffff5...5ffff5ffff55ff554469ffffffffff5ffff5
5ffff5ff966544469fffffffffffff5ffff5...dffffdffff566664469ff999ffffffdffffd....5ffff5ffff9444469fffffffffffff5ffff5...5ffff5fff59ff55444465fffffffff5ffff5
5ffff5ff9946544465fff999ffffff5ffff5...dffffdfff95555566469ffaa9fffffdffffd....5ffff5fffff9444465fff9999fffff5ffff5...5ffff5ff549ff544444465ffffffff5ffff5
5ffff5ff9944654445ffffaa9fffff5ffff5...dffffdfff954444556655577755fffdffffd....5ffff5fffff55444555fffaaa9ffff5ffff5...5ffff5ff546555444444655555ffff5ffff5
5ffff5ff9444465555f55577755fff5ffff5...dffffdff95444444454447888765ffdffffd....5ffff5fffff5455566655777755fff5ffff5...5ffff5ff5466665555555667775fff5ffff5
5ffff5ff44444444445447888765ff5ffff5...dffffdff95444444454447888765ffdffffd....5ffff5ffff954444444478888765ff5ffff5...5ffff5ff55555554444444788875ff5ffff5
5ffff5ff44444444445447888765ff5ffff5...dffffdfff954444554655577755fffdffffd....5ffff5ffff954444444478888765ff5ffff5...5ffff5ff55555554444444788875ff5ffff5
5ffff5ff9444465555f55577755fff5ffff5...dffffdfff95555566469ffaa9fffffdffffd....5ffff5fffff5455566655777755fff5ffff5...5ffff5ff5466665555555667775fff5ffff5
5ffff5ff9944654445ffffaa9fffff5ffff5...dffffdffff566664469ff999ffffffdffffd....5ffff5fffff55444555fffaaa9ffff5ffff5...5ffff5ff546555444444655555ffff5ffff5
5ffff5ff9966544465fff999ffffff5ffff5...dffffdffff54444469ffffffffffffdffffd....5ffff5fffff9444465fff9999fffff5ffff5...5ffff5ff549ff544444465ffffffff5ffff5
5ffff5ff965544469fffffffffffff5ffff5...dffffdfffff5444469ffffffffffffdffffd....5ffff5ffff9444469fffffffffffff5ffff5...5ffff5fff59ff55444465fffffffff5ffff5
5ffff5ff55444469ffffffffffffff5ffff5...dffffdffffff544469ffffffffffffdffffd....5ffff5fff9444669ffffffffffffff5ffff5...5ffff5ffff55ff554469ffffffffff5ffff5
5ffff5ff5444469fffffffffffffff5ffff5...dffffdffffff5444469fffffffffffdffffd....5ffff5ff9446699fffffffffffffff5ffff5...5ffff5fffffffff54469ffffffffff5ffff5
5ffff5fff54469ffffffffffffffff5ffff5...dffffdfffffff5444469ffffffffffdffffd....5ffff5ff56699fffffffffffffffff5ffff5...5ffff5ffffffffff54469fffffffff5ffff5
5ffff5fff5669fffffffffffffffff5ffff5...dffffdffffffff5555555fffffffffdffffd....5ffff5ff565fffffffffffffffffff5ffff5...5ffff5fffffffffff5669fffffffff5ffff5
5ffff5ffff55ffffffffffffffffff5ffff5...dffffdffffffffffffffffffffffffdffffd....5ffff5ff55ffffffffffffffffffff5ffff5...5ffff5ffffffffffff5555ffffffff5ffff5
5ffff5ffffffffffffffffffffffff5ffff5...dffffdffffffffffffffffffffffffdffffd....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
5ffff5ffffffffffffffffffffffff5ffff5...dffffddddddddddddddddddddddddddffffd....5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5
5ffff55555555555555555555555555ffff5...dffffffffffffffffffffffffffffffffffd....5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffdddffdffffdfdddddfdddfffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5f5555f55555f5555f5f5ff5f5555f5555f5...dffffffdffdfdffffdfffdfffffdfffffffd....5ff5555f5555f5ffff5555f5555f5ff5fff5...5fffffff5555f5ff5f5555f5555ffffffff5
5f5ffffff5fff5ff5f5f5ff5f5ffff5ff5f5...dffffffdddffdffffdfffdffffdffffffffd....5ff5ffff5ff5f5ffff5ffff5ff5f55f5fff5...5ffffffffff5f5ff5f5ffff5fffffffffff5
5f5555fff5fff5555f5f555ff555ff5555f5...dffffffdffdfdffffdfffdfffdfffffffffd....5ff555ff5555f5ffff5ffff5ff5f5f55fff5...5ffffffffff5f5ff5f5f55f5f55ffffffff5
5ffff5fff5fff5f5ff5f5ff5f5ffff5f5ff5...dffffffdddffddddfdfffdfffdddfffffffd....5ff5ffff5ff5f5ffff5ffff5ff5f5ff5fff5...5fffffff5ff5f5ff5f5ff5f5ff5ffffffff5
5f5555fff5fff5f55f5f5ff5f5555f5f55f5...dffffffffffffffffffffffffffffffffffd....5ff5ffff5ff5f5555f5555f5555f5ff5fff5...5fffffff5555f5555f5555f5555ffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffffffddddfddddfdddddffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffdffdffffdffdfffdffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffdddfdddffddddfffdffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffdffdffffdfdffffdffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffffffdffffdfddfffdffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffffff222ff2fff2f2222ffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffffff2ff2f22f22f2fffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffff222f2ff2f2f2f2f2f22ffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffffff2ff2f2fff2f2ff2ffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dfffffffffff222ff2fff2f2222ffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...dddddddddddddddddddddddddddddddddddd....5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5
555555555555555555555555555555555555...........................................555555555555555555555555555555555555...555555555555555555555555555555555555
`,
img`
...............................................................................dddddddddddddddddddddddddddddddddddd.......................................
555555555555555555555555555555555555...555555555555555555555555555555555555....dffffffffffffffffffffffffffffffffffd...555555555555555555555555555555555555
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffddddddddddddddddddddddddddffffd...5ffffffffffffffffffffffffffffffffff5
5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5....dffffdffffffffffffffffffffffffdffffd...5ffff55555555555555555555555555ffff5
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....dffffdffffffffffffffffffffffffdffffd...5ffff5ffffffffffffffffffffffff5ffff5
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....dffffdff55ffffffffffffffffffffdffffd...5ffff5ffffffffffffffffffffffff5ffff5
5ffff5ffff55ffffffffffffffffff5ffff5...5ffff5ffffffff5555555fffffffff5ffff5....dffffdff565fffffffffffffffffffdffffd...5ffff5ffffffffffff5555ffffffff5ffff5
5ffff5fff5669fffffffffffffffff5ffff5...5ffff5fffffff5444469ffffffffff5ffff5....dffffdff56699fffffffffffffffffdffffd...5ffff5fffffffffff5669fffffffff5ffff5
5ffff5fff54469ffffffffffffffff5ffff5...5ffff5ffffff5444469fffffffffff5ffff5....dffffdff9446699fffffffffffffffdffffd...5ffff5ffffffffff54469fffffffff5ffff5
5ffff5ff5444469fffffffffffffff5ffff5...5ffff5ffffff544469ffffffffffff5ffff5....dffffdfff9444669ffffffffffffffdffffd...5ffff5fffffffff54469ffffffffff5ffff5
5ffff5ff55544469ffffffffffffff5ffff5...5ffff5fffff5444469ffffffffffff5ffff5....dffffdffff9444469fffffffffffffdffffd...5ffff5ffff55ff554469ffffffffff5ffff5
5ffff5ff966544469fffffffffffff5ffff5...5ffff5ffff54444469ffffffffffff5ffff5....dffffdfffff9444465fff9999fffffdffffd...5ffff5fff59ff55444465fffffffff5ffff5
5ffff5ff9946544465fff999ffffff5ffff5...5ffff5ffff566664469ff999ffffff5ffff5....dffffdfffff55444555fffaaa9ffffdffffd...5ffff5ff549ff544444465ffffffff5ffff5
5ffff5ff9944654445ffffaa9fffff5ffff5...5ffff5fff95555566469ffaa9fffff5ffff5....dffffdfffff5455566655777755fffdffffd...5ffff5ff546555444444655555ffff5ffff5
5ffff5ff9444465555f55577755fff5ffff5...5ffff5fff954444556655577755fff5ffff5....dffffdffff954444444478888765ffdffffd...5ffff5ff5466665555555667775fff5ffff5
5ffff5ff44444444445447888765ff5ffff5...5ffff5ff95444444454447888765ff5ffff5....dffffdffff954444444478888765ffdffffd...5ffff5ff55555554444444788875ff5ffff5
5ffff5ff44444444445447888765ff5ffff5...5ffff5ff95444444454447888765ff5ffff5....dffffdfffff5455566655777755fffdffffd...5ffff5ff55555554444444788875ff5ffff5
5ffff5ff9444465555f55577755fff5ffff5...5ffff5fff954444554655577755fff5ffff5....dffffdfffff55444555fffaaa9ffffdffffd...5ffff5ff5466665555555667775fff5ffff5
5ffff5ff9944654445ffffaa9fffff5ffff5...5ffff5fff95555566469ffaa9fffff5ffff5....dffffdfffff9444465fff9999fffffdffffd...5ffff5ff546555444444655555ffff5ffff5
5ffff5ff9966544465fff999ffffff5ffff5...5ffff5ffff566664469ff999ffffff5ffff5....dffffdffff9444469fffffffffffffdffffd...5ffff5ff549ff544444465ffffffff5ffff5
5ffff5ff965544469fffffffffffff5ffff5...5ffff5ffff54444469ffffffffffff5ffff5....dffffdfff9444669ffffffffffffffdffffd...5ffff5fff59ff55444465fffffffff5ffff5
5ffff5ff55444469ffffffffffffff5ffff5...5ffff5fffff5444469ffffffffffff5ffff5....dffffdff9446699fffffffffffffffdffffd...5ffff5ffff55ff554469ffffffffff5ffff5
5ffff5ff5444469fffffffffffffff5ffff5...5ffff5ffffff544469ffffffffffff5ffff5....dffffdff56699fffffffffffffffffdffffd...5ffff5fffffffff54469ffffffffff5ffff5
5ffff5fff54469ffffffffffffffff5ffff5...5ffff5ffffff5444469fffffffffff5ffff5....dffffdff565fffffffffffffffffffdffffd...5ffff5ffffffffff54469fffffffff5ffff5
5ffff5fff5669fffffffffffffffff5ffff5...5ffff5fffffff5444469ffffffffff5ffff5....dffffdff55ffffffffffffffffffffdffffd...5ffff5fffffffffff5669fffffffff5ffff5
5ffff5ffff55ffffffffffffffffff5ffff5...5ffff5ffffffff5555555fffffffff5ffff5....dffffdffffffffffffffffffffffffdffffd...5ffff5ffffffffffff5555ffffffff5ffff5
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....dffffdffffffffffffffffffffffffdffffd...5ffff5ffffffffffffffffffffffff5ffff5
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....dffffddddddddddddddddddddddddddffffd...5ffff5ffffffffffffffffffffffff5ffff5
5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5....dffffffffffffffffffffffffffffffffffd...5ffff55555555555555555555555555ffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffddddfddddfdffffddddfddddfdffdfffd...5ffffffffffffffffffffffffffffffffff5
5f5555f55555f5555f5f5ff5f5555f5555f5...5ffffff555ff5ffff5f55555f555fffffff5....dffdffffdffdfdffffdffffdffdfddfdfffd...5fffffff5555f5ff5f5555f5555ffffffff5
5f5ffffff5fff5ff5f5f5ff5f5ffff5ff5f5...5ffffff5ff5f5ffff5fff5fffff5fffffff5....dffdddffddddfdffffdffffdffdfdfddfffd...5ffffffffff5f5ff5f5ffff5fffffffffff5
5f5555fff5fff5555f5f555ff555ff5555f5...5ffffff555ff5ffff5fff5ffff5ffffffff5....dffdffffdffdfdffffdffffdffdfdffdfffd...5ffffffffff5f5ff5f5f55f5f55ffffffff5
5ffff5fff5fff5f5ff5f5ff5f5ffff5f5ff5...5ffffff5ff5f5ffff5fff5fff5fffffffff5....dffdffffdffdfddddfddddfddddfdffdfffd...5fffffff5ff5f5ff5f5ff5f5ff5ffffffff5
5f5555fff5fff5f55f5f5ff5f5555f5f55f5...5ffffff555ff5555f5fff5fff555fffffff5....dffffffffffffffffffffffffffffffffffd...5fffffff5555f5555f5555f5555ffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffffffddddfddddfdddffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffdffdffffdffdfdffdfffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffdddfddddfddddfdffdfffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffdfffffdfdffffdffdfffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffffffddddfdffffdddffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffffff2222f2222f22222ffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffffff2ffff2ff2fff2ffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffff222f222ff2222fff2ffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffffff2ffff2f2ffff2ffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dfffffffffff2ffff2f22fff2ffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dffffffffffffffffffffffffffffffffffd...5ffffffffffffffffffffffffffffffffff5
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....dddddddddddddddddddddddddddddddddddd...5ffffffffffffffffffffffffffffffffff5
555555555555555555555555555555555555...555555555555555555555555555555555555...........................................555555555555555555555555555555555555
`,
img`
......................................................................................................................dddddddddddddddddddddddddddddddddddd
555555555555555555555555555555555555...555555555555555555555555555555555555....555555555555555555555555555555555555...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffddddddddddddddddddddddddddffffd
5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5....5ffff55555555555555555555555555ffff5...dffffdffffffffffffffffffffffffdffffd
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...dffffdffffffffffffffffffffffffdffffd
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...dffffdffffffffffff5555ffffffffdffffd
5ffff5ffff55ffffffffffffffffff5ffff5...5ffff5ffffffff5555555fffffffff5ffff5....5ffff5ff55ffffffffffffffffffff5ffff5...dffffdfffffffffff5669fffffffffdffffd
5ffff5fff5669fffffffffffffffff5ffff5...5ffff5fffffff5444469ffffffffff5ffff5....5ffff5ff565fffffffffffffffffff5ffff5...dffffdffffffffff54469fffffffffdffffd
5ffff5fff54469ffffffffffffffff5ffff5...5ffff5ffffff5444469fffffffffff5ffff5....5ffff5ff56699fffffffffffffffff5ffff5...dffffdfffffffff54469ffffffffffdffffd
5ffff5ff5444469fffffffffffffff5ffff5...5ffff5ffffff544469ffffffffffff5ffff5....5ffff5ff9446699fffffffffffffff5ffff5...dffffdffff55ff554469ffffffffffdffffd
5ffff5ff55544469ffffffffffffff5ffff5...5ffff5fffff5444469ffffffffffff5ffff5....5ffff5fff9444669ffffffffffffff5ffff5...dffffdfff59ff55444465fffffffffdffffd
5ffff5ff966544469fffffffffffff5ffff5...5ffff5ffff54444469ffffffffffff5ffff5....5ffff5ffff9444469fffffffffffff5ffff5...dffffdff549ff544444465ffffffffdffffd
5ffff5ff9946544465fff999ffffff5ffff5...5ffff5ffff566664469ff999ffffff5ffff5....5ffff5fffff9444465fff9999fffff5ffff5...dffffdff546555444444655555ffffdffffd
5ffff5ff9944654445ffffaa9fffff5ffff5...5ffff5fff95555566469ffaa9fffff5ffff5....5ffff5fffff55444555fffaaa9ffff5ffff5...dffffdff5466665555555667775fffdffffd
5ffff5ff9444465555f55577755fff5ffff5...5ffff5fff954444556655577755fff5ffff5....5ffff5fffff5455566655777755fff5ffff5...dffffdff55555554444444788875ffdffffd
5ffff5ff44444444445447888765ff5ffff5...5ffff5ff95444444454447888765ff5ffff5....5ffff5ffff954444444478888765ff5ffff5...dffffdff55555554444444788875ffdffffd
5ffff5ff44444444445447888765ff5ffff5...5ffff5ff95444444454447888765ff5ffff5....5ffff5ffff954444444478888765ff5ffff5...dffffdff5466665555555667775fffdffffd
5ffff5ff9444465555f55577755fff5ffff5...5ffff5fff954444554655577755fff5ffff5....5ffff5fffff5455566655777755fff5ffff5...dffffdff546555444444655555ffffdffffd
5ffff5ff9944654445ffffaa9fffff5ffff5...5ffff5fff95555566469ffaa9fffff5ffff5....5ffff5fffff55444555fffaaa9ffff5ffff5...dffffdff549ff544444465ffffffffdffffd
5ffff5ff9966544465fff999ffffff5ffff5...5ffff5ffff566664469ff999ffffff5ffff5....5ffff5fffff9444465fff9999fffff5ffff5...dffffdfff59ff55444465fffffffffdffffd
5ffff5ff965544469fffffffffffff5ffff5...5ffff5ffff54444469ffffffffffff5ffff5....5ffff5ffff9444469fffffffffffff5ffff5...dffffdffff55ff554469ffffffffffdffffd
5ffff5ff55444469ffffffffffffff5ffff5...5ffff5fffff5444469ffffffffffff5ffff5....5ffff5fff9444669ffffffffffffff5ffff5...dffffdfffffffff54469ffffffffffdffffd
5ffff5ff5444469fffffffffffffff5ffff5...5ffff5ffffff544469ffffffffffff5ffff5....5ffff5ff9446699fffffffffffffff5ffff5...dffffdffffffffff54469fffffffffdffffd
5ffff5fff54469ffffffffffffffff5ffff5...5ffff5ffffff5444469fffffffffff5ffff5....5ffff5ff56699fffffffffffffffff5ffff5...dffffdfffffffffff5669fffffffffdffffd
5ffff5fff5669fffffffffffffffff5ffff5...5ffff5fffffff5444469ffffffffff5ffff5....5ffff5ff565fffffffffffffffffff5ffff5...dffffdffffffffffff5555ffffffffdffffd
5ffff5ffff55ffffffffffffffffff5ffff5...5ffff5ffffffff5555555fffffffff5ffff5....5ffff5ff55ffffffffffffffffffff5ffff5...dffffdffffffffffffffffffffffffdffffd
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...dffffdffffffffffffffffffffffffdffffd
5ffff5ffffffffffffffffffffffff5ffff5...5ffff5ffffffffffffffffffffffff5ffff5....5ffff5ffffffffffffffffffffffff5ffff5...dffffddddddddddddddddddddddddddffffd
5ffff55555555555555555555555555ffff5...5ffff55555555555555555555555555ffff5....5ffff55555555555555555555555555ffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffffddddfdffdfddddfddddffffffffd
5f5555f55555f5555f5f5ff5f5555f5555f5...5ffffff555ff5ffff5f55555f555fffffff5....5ff5555f5555f5ffff5555f5555f5ff5fff5...dffffffffffdfdffdfdffffdfffffffffffd
5f5ffffff5fff5ff5f5f5ff5f5ffff5ff5f5...5ffffff5ff5f5ffff5fff5fffff5fffffff5....5ff5ffff5ff5f5ffff5ffff5ff5f55f5fff5...dffffffffffdfdffdfdfddfdfddffffffffd
5f5555fff5fff5555f5f555ff555ff5555f5...5ffffff555ff5ffff5fff5ffff5ffffffff5....5ff555ff5555f5ffff5ffff5ff5f5f55fff5...dfffffffdffdfdffdfdffdfdffdffffffffd
5ffff5fff5fff5f5ff5f5ff5f5ffff5f5ff5...5ffffff5ff5f5ffff5fff5fff5fffffffff5....5ff5ffff5ff5f5ffff5ffff5ff5f5ff5fff5...dfffffffddddfddddfddddfddddffffffffd
5f5555fff5fff5f55f5f5ff5f5555f5f55f5...5ffffff555ff5555f5fff5fff555fffffff5....5ff5ffff5ff5f5555f5555f5555f5ff5fff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffdffdfddddfffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffffffffdffdffdfdffdfffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffdddfddddfddddfffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffffffffdffdffdfdffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffdffdfdffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffffffff2222f2222f222ffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffffffff2ffff2ff2f2ff2fffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffff222f2222f2222f2ff2fffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffff2f2ffff2ff2fffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dfffffffffff2222f2ffff222ffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dffffffffffffffffffffffffffffffffffd
5ffffffffffffffffffffffffffffffffff5...5ffffffffffffffffffffffffffffffffff5....5ffffffffffffffffffffffffffffffffff5...dddddddddddddddddddddddddddddddddddd
555555555555555555555555555555555555...555555555555555555555555555555555555....555555555555555555555555555555555555.......................................
`
]

const difficultySelectFrames = [
img`
.dddddddddddddddddddddddddddddddddddd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dfffffffddddfddddfddddfdffdffffffffd
.dfffffffdffffdffdfdffffdffdffffffffd
.dfffffffdddffddddfddddfddddffffffffd
.dfffffffdffffdffdffffdfffdfffffffffd
.dfffffffddddfdffdfddddfffdfffffffffd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dddddddddddddddddddddddddddddddddddd
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fff5ff5f5555f5555f5fff5f5555f5ffff5.
5fff55f5f5ff5f5ff5f55f55f5ff5f5ffff5.
5fff5f55f5ff5f5555f5f5f5f5555f5ffff5.
5fff5ff5f5ff5f5f5ff5fff5f5ff5f5ffff5.
5fff5ff5f5555f5f55f5fff5f5ff5f555ff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fffffff5ff5f5555f5555f555fffffffff5.
5fffffff5ff5f5ff5f5ff5f5ff5ffffffff5.
5fffffff5555f5555f5555f5ff5ffffffff5.
5fffffff5ff5f5ff5f5f5ff5ff5ffffffff5.
5fffffff5ff5f5ff5f5f55f555fffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fff555f5ff5f5555f5555f5ff5f5555fff5.
5ffff5ff55f5f5ffff5ff5f55f5f5ffffff5.
5ffff5ff5f55f5555f5555f5f55f555ffff5.
5ffff5ff5ff5ffff5f5ff5f5ff5f5ffffff5.
5fff555f5ff5f5555f5ff5f5ff5f5555fff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
`,
img`
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fffffff5555f5555f5555f5ff5ffffffff5.
5fffffff5ffff5ff5f5ffff5ff5ffffffff5.
5fffffff555ff5555f5555f5555ffffffff5.
5fffffff5ffff5ff5ffff5fff5fffffffff5.
5fffffff5555f5ff5f5555fff5fffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
.dddddddddddddddddddddddddddddddddddd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dfffdffdfddddfddddfdfffdfddddfdffffd
.dfffddfdfdffdfdffdfddfddfdffdfdffffd
.dfffdfddfdffdfddddfdfdfdfddddfdffffd
.dfffdffdfdffdfdfdffdfffdfdffdfdffffd
.dfffdffdfddddfdfddfdfffdfdffdfdddffd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dddddddddddddddddddddddddddddddddddd
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fffffff5ff5f5555f5555f555fffffffff5.
5fffffff5ff5f5ff5f5ff5f5ff5ffffffff5.
5fffffff5555f5555f5555f5ff5ffffffff5.
5fffffff5ff5f5ff5f5f5ff5ff5ffffffff5.
5fffffff5ff5f5ff5f5f55f555fffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fff555f5ff5f5555f5555f5ff5f5555fff5.
5ffff5ff55f5f5ffff5ff5f55f5f5ffffff5.
5ffff5ff5f55f5555f5555f5f55f555ffff5.
5ffff5ff5ff5ffff5f5ff5f5ff5f5ffffff5.
5fff555f5ff5f5555f5ff5f5ff5f5555fff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
`,
img`
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fffffff5555f5555f5555f5ff5ffffffff5.
5fffffff5ffff5ff5f5ffff5ff5ffffffff5.
5fffffff555ff5555f5555f5555ffffffff5.
5fffffff5ffff5ff5ffff5fff5fffffffff5.
5fffffff5555f5ff5f5555fff5fffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fff5ff5f5555f5555f5fff5f5555f5ffff5.
5fff55f5f5ff5f5ff5f55f55f5ff5f5ffff5.
5fff5f55f5ff5f5555f5f5f5f5555f5ffff5.
5fff5ff5f5ff5f5f5ff5fff5f5ff5f5ffff5.
5fff5ff5f5555f5f55f5fff5f5ff5f555ff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
.dddddddddddddddddddddddddddddddddddd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dfffffffdffdfddddfddddfdddfffffffffd
.dfffffffdffdfdffdfdffdfdffdffffffffd
.dfffffffddddfddddfddddfdffdffffffffd
.dfffffffdffdfdffdfdfdffdffdffffffffd
.dfffffffdffdfdffdfdfddfdddfffffffffd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dddddddddddddddddddddddddddddddddddd
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fff555f5ff5f5555f5555f5ff5f5555fff5.
5ffff5ff55f5f5ffff5ff5f55f5f5ffffff5.
5ffff5ff5f55f5555f5555f5f55f555ffff5.
5ffff5ff5ff5ffff5f5ff5f5ff5f5ffffff5.
5fff555f5ff5f5555f5ff5f5ff5f5555fff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
`,
img`
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fffffff5555f5555f5555f5ff5ffffffff5.
5fffffff5ffff5ff5f5ffff5ff5ffffffff5.
5fffffff555ff5555f5555f5555ffffffff5.
5fffffff5ffff5ff5ffff5fff5fffffffff5.
5fffffff5555f5ff5f5555fff5fffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fff5ff5f5555f5555f5fff5f5555f5ffff5.
5fff55f5f5ff5f5ff5f55f55f5ff5f5ffff5.
5fff5f55f5ff5f5555f5f5f5f5555f5ffff5.
5fff5ff5f5ff5f5f5ff5fff5f5ff5f5ffff5.
5fff5ff5f5555f5f55f5fff5f5ff5f555ff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
555555555555555555555555555555555555.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5fffffff5ff5f5555f5555f555fffffffff5.
5fffffff5ff5f5ff5f5ff5f5ff5ffffffff5.
5fffffff5555f5555f5555f5ff5ffffffff5.
5fffffff5ff5f5ff5f5f5ff5ff5ffffffff5.
5fffffff5ff5f5ff5f5f55f555fffffffff5.
5ffffffffffffffffffffffffffffffffff5.
5ffffffffffffffffffffffffffffffffff5.
555555555555555555555555555555555555.
.....................................
.....................................
.....................................
.....................................
.dddddddddddddddddddddddddddddddddddd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dfffdddfdffdfddddfddddfdffdfddddfffd
.dffffdffddfdfdffffdffdfddfdfdffffffd
.dffffdffdfddfddddfddddfdfddfdddffffd
.dffffdffdffdffffdfdffdfdffdfdffffffd
.dfffdddfdffdfddddfdffdfdffdfddddfffd
.dffffffffffffffffffffffffffffffffffd
.dffffffffffffffffffffffffffffffffffd
.dddddddddddddddddddddddddddddddddddd
`
]

const shipSprites = [
img`
..55................
.5669...............
.54469..............
5444469.............
55544469............
966544469...........
9946544465...999....
9944654445....aa9...
9444465555.55577755.
44444444445447888765
44444444445447888765
9444465555.55577755.
9944654445....aa9...
9966544465...999....
965544469...........
55444469............
5444469.............
.54469..............
.5669...............
..55................
`,
img`
......5555555.......
.....5444469........
....5444469.........
....544469..........
...5444469..........
..54444469..........
..566664469..999....
.95555566469..aa9...
.954444556655577755.
95444444454447888765
95444444454447888765
.954444554655577755.
.95555566469..aa9...
..566664469..999....
..54444469..........
...5444469..........
....544469..........
....5444469.........
.....5444469........
......5555555.......
`,
img`
55..................
565.................
56699...............
9446699.............
.9444669............
..9444469...........
...9444465...9999...
...55444555...aaa9..
...5455566655777755.
..954444444478888765
..954444444478888765
...5455566655777755.
...55444555...aaa9..
...9444465...9999...
..9444469...........
.9444669............
9446699.............
56699...............
565.................
55..................
`,
img`
..........5555......
.........5669.......
........54469.......
.......54469........
..55..554469........
.59..55444465.......
549..544444465......
546555444444655555..
5466665555555667775.
55555554444444788875
55555554444444788875
5466665555555667775.
546555444444655555..
549..544444465......
.59..55444465.......
..55..554469........
.......54469........
........54469.......
.........5669.......
..........5555......
`
]

const enemySprites = [
img`
. . . . . . . . b b . . 
. . . . . . . b 2 b . . 
. . . . . . b 2 3 b . . 
. . . . . . b b b b . . 
. . . . b b 3 3 3 b . . 
. . b b 2 3 3 3 b b b b 
. b 2 b b 2 3 b 6 4 5 b 
b 3 b 6 4 b 2 b 6 4 5 b 
b 3 b 6 4 b 2 b 6 4 5 b 
. b 2 b b 2 3 b 6 4 5 b 
. . b b 2 3 3 3 b b b b 
. . . . b b 3 3 3 b . . 
. . . . . . b b b b . . 
. . . . . . b 2 3 b . . 
. . . . . . . b 2 b . . 
. . . . . . . . b b . . 
`,
img`
..........bbbb......
.........b2222b.....
.........b2222b.....
......bbb223322b....
.....bb4b233332b....
.....b4b22333322b...
.....bbb23333332bb..
...bbbbbbbbbbbbbbb..
.bb222bbbb2222222bbb
b2233b6444b333332b5b
b2233b6444b333332b5b
.bb222bbbb2222222bbb
...bbbbbbbbbbbbbbb..
.....bbb23333332bb..
.....b4b22333322b...
.....bb4b233332b....
......bbb223322b....
.........b2222b.....
.........b2222b.....
..........bbbb......
`,
img`
......bbbbbb......
...bbb233332b.....
..b333b233332b....
.b2233b2233332b...
bbbbbbbbb233332b..
.......bbbb33332b.
......bb333333222b
....bb45533222222b
....b4452222222b2b
....b4452222222b2b
....bb45533222222b
......bb333333222b
.......bbbb33332b.
bbbbbbbbb233332b..
.b2233b2233332b...
..b333b233332b....
...bbb233332b.....
......bbbbbb......
`
]

let title = sprites.create(img`
........666666666.6666666666.666666666.66666666.66666666........
........666666666.6666666666.666666666.66666666.66666666........
........666666666.6666666666.666666666.66666666.66666666........
........666.......666....666.666...666.666......666.............
........444.......444....444.444...444.444......444.............
........444444444.444....444.444...444.444......444444..........
........444444444.444....444.444444444.444......444444..........
........444444444.4444444444.444444444.444......444444..........
..............444.4444444444.444444444.444......444.............
..............555.5555555555.555...555.555......555.............
........555555555.555........555...555.55555555.55555555........
........555555555.555........555...555.55555555.55555555........
........555555555.555........555...555.55555555.55555555........
................................................................
.5555555..55555555.55555555.55555555.555...555.55555555.55555555
555555555.55555555.55555555.55555555.5555..555.55555555.55555555
555555555.55555555.55555555.55555555.5555..555.55555555.55555555
555...555.555......555......555......55555.555.555......555.....
444...444.444......444......444......44444.444.444......444.....
444...444.444444...444444...444444...444444444.444......444444..
444...444.444444...444444...444444...444444444.444......444444..
444...444.444444...444444...444444...444444444.444......444444..
444...444.444......444......444......444.44444.444......444.....
444...444.444......444......444......444.44444.444......444.....
666...666.666......666......666......666..6666.666......666.....
666666666.666......666......66666666.666..6666.66666666.66666666
666666666.666......666......66666666.666...666.66666666.66666666
.6666666..666......666......66666666.666...666.66666666.66666666
`)
let waveLabel: Sprite
let ammoLabel: Sprite

const bulletImg = img`
. 7 7 . 
7 8 8 7 
7 8 8 7 
. 7 7 . 
`
const enemyBulletImg = img`
. b b . 
b 3 3 b 
b 3 3 b 
. b b . 
`
const difficulties = [0.7, 1, 1.5, 2]
let difficultyIndex = 0

const spdMultiplier = .4
const bulletSpeed = 3

let selectMenu: Sprite
let player: Sprite

let state = "menu"
let selectIndex = 0

let playerVelocity = [0, 0]
let fireDelay: number
let lastFire = 0

let spawnRate: number
let lastEnemySpawn = 0

let activeEnemies:Array<Sprite> = []
let wave = 0
let enemiesToSpawn = 0

let ammo: number

scene.setBackgroundImage(img`
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6ffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffff1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6ffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefeffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefeffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffff1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffefefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1fffffffffff
fffffffffffffffffffffffffffffffffffefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1ffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffefefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeeeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffffffff
ffffffffff1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffefffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1fffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff111fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffff1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffff111fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6ffffffffffffffffffffffffff
ffffffffffff1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
`)


controller.up.onEvent(ControllerButtonEvent.Pressed, function() {
    if (state == "playing"){
        playerVelocity[1] = Math.sign(controller.dy())
    } else if (state == "difficultySelect") {
        if (difficultyIndex <= 0) {
            difficultyIndex = 3
        } else {
            difficultyIndex--
        }
        selectMenu.setImage(difficultySelectFrames[difficultyIndex])
    }
})

controller.up.onEvent(ControllerButtonEvent.Released, function () {
    if (state == "playing") {
        playerVelocity[1] = Math.sign(controller.dy())
    }
})

controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
    if (state == "playing") {
        playerVelocity[1] = Math.sign(controller.dy())
    } else if (state == "difficultySelect") {
        if (difficultyIndex >= 3) {
            difficultyIndex = 0
        } else {
            difficultyIndex++
        }
    }
    selectMenu.setImage(difficultySelectFrames[difficultyIndex])
})

controller.down.onEvent(ControllerButtonEvent.Released, function () {
    if (state == "playing") {
        playerVelocity[1] = Math.sign(controller.dy())
    }
})

controller.A.onEvent(ControllerButtonEvent.Pressed, function() {
    if (state == "menu"){
        title.destroy()
        title = textsprite.create("Select your ship", 15)
        title.setPosition(80, 32)
        selectMenu = sprites.create(classSelectFrames[0])
        selectMenu.setPosition(80, 80)
        state = "classSelect"
    }else if (state == "classSelect"){
        fireDelay = Math.round(1000 / shipStats[selectIndex].frt)
        selectMenu.destroy()
        selectMenu = sprites.create(difficultySelectFrames[0])
        selectMenu.setPosition(80, 80)
        title.destroy()
        title = textsprite.create("Select difficulty", 15)
        title.setPosition(80, 32)
        state = "difficultySelect"
    }else if(state == "difficultySelect"){
        selectMenu.destroy()
        title.destroy()
        player = sprites.create(shipSprites[selectIndex], SpriteKind.Player)
        player.setPosition(24, 64)
        spawnRate = Math.round(1000/difficulties[difficultyIndex])
        setupWave()
    }else if (state == "playing"){
        if (game.runtime()-lastFire < fireDelay || ammo <= 0) return
        lastFire = game.runtime()
        let projectile = sprites.createProjectile(bulletImg, 150, 0, SpriteKind.Projectile)
        projectile.setPosition(player.x + 12, player.y)
        ammo--
        ammoLabel.destroy()
        ammoLabel = textsprite.create(convertToText(ammo), 15, 4)
        ammoLabel.setPosition(6, 116)
    }
})

controller.left.onEvent(ControllerButtonEvent.Pressed, function() {
    if (state == "classSelect"){
        if (selectIndex > 0) {
            selectIndex -= 1
        } else {
            selectIndex = classSelectFrames.length - 1
        }
        selectMenu.setImage(classSelectFrames[selectIndex])
    } else if (state == "playing") {
        playerVelocity[0] = Math.sign(controller.dx())
    }
})

controller.left.onEvent(ControllerButtonEvent.Released, function () {
    if (state == "playing") {
        playerVelocity[0] = Math.sign(controller.dx())
    }
})

controller.right.onEvent(ControllerButtonEvent.Pressed, function() {
    if (state == "classSelect") {
        if (selectIndex < classSelectFrames.length - 1) {
            selectIndex += 1
        } else {
            selectIndex = 0
        }
        selectMenu.setImage(classSelectFrames[selectIndex])
    } else if (state == "playing"){
        playerVelocity[0] = Math.sign(controller.dx())
    }
})

controller.right.onEvent(ControllerButtonEvent.Released, function() {
    if (state == "playing"){
        playerVelocity[0] = Math.sign(controller.dx())
    }
})

sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function(bullet: Sprite, enemy: Sprite) {
    if (state != "playing") return
    let enemyHealth = sprites.readDataNumber(enemy, "health")
    bullet.destroy()
    enemyHealth -= shipStats[selectIndex].dmg
    if (enemyHealth <= 0){
        activeEnemies.splice(activeEnemies.indexOf(enemy), 1)
        enemy.destroy()
        enemiesToSpawn--
        if (enemiesToSpawn > 0) return
        console.log("Wave ended")
        endWave()
    }else {
        sprites.setDataNumber(enemy, "health", enemyHealth)
    }
})

sprites.onOverlap(SpriteKind.EnemyProjectile, SpriteKind.Player, function(bullet: Sprite, plr: Sprite) {
    if (state != "playing") return
    bullet.destroy()
    info.changeLifeBy(-1)
})

sprites.onOverlap(SpriteKind.Enemy, SpriteKind.Player, function(enemy: Sprite, plr: Sprite){
    info.changeLifeBy(-sprites.readDataNumber(enemy, "health")/2)
    activeEnemies.splice(activeEnemies.indexOf(enemy), 1)
    enemy.destroy()
    enemiesToSpawn--
})


function setupWave(){
    info.setLife(shipStats[selectIndex].hp)
    wave++
    waveLabel = textsprite.create("WAVE " + wave)
    waveLabel.z = 1
    waveLabel.setPosition(80, 6)
    enemiesToSpawn = Math.round(Math.clamp(10, 40 + (20 * difficulties[difficultyIndex]), 10 + (Math.pow(wave, 1.5) * difficulties[difficultyIndex])))
    ammo = Math.round(enemiesToSpawn + enemiesToSpawn*(1/difficulties[difficultyIndex]*.6))
    ammoLabel = textsprite.create(convertToText(ammo), 15, 4)
    ammoLabel.setPosition(6, 116)
    lastEnemySpawn = game.runtime()
    state = "playing"
}

function endWave(){
    state = "shop"
    for (let v of activeEnemies) v.destroy()
    activeEnemies = []
    waveLabel.destroy()
    ammoLabel.destroy()
    playerVelocity = [0, 0]
    basic.pause(5000)
    setupWave()
}


function spawnEnemy() {
    let enemyIndex = randint(0, enemyStats.length-1)
    let enemy = sprites.create(enemySprites[enemyIndex], SpriteKind.Enemy)
    enemy.setPosition(160, randint(12, 108))
    sprites.setDataNumber(enemy, "health", enemyStats[enemyIndex].hp)
    sprites.setDataNumber(enemy, "index", enemyIndex)
    sprites.setDataNumber(enemy, "moveDirY", Math.pickRandom([-1, 1]))
    sprites.setDataNumber(enemy, "lastShot", game.runtime())
    return enemy
}

function updateEnemies() {
    for (let enemy of activeEnemies){
        let i = activeEnemies.indexOf(enemy)
        let enemyIndex = sprites.readDataNumber(enemy, "index")
        let enemyDir = [0, 0]
        if ((i == 0 && enemy.x > 80) || (i != 0 && enemy.x > 80 + 20*i)){
            enemyDir[0] = -1
        }
        if (enemy.y <= 10) sprites.setDataNumber(enemy, "moveDirY", 1)
        else if (enemy.y >= 110) sprites.setDataNumber(enemy, "moveDirY", -1)
        enemyDir[1] = sprites.readDataNumber(enemy, "moveDirY")
        enemyDir = normalize(enemyDir[0], enemyDir[1])
        enemy.setPosition(enemy.x + enemyDir[0] * enemyStats[enemyIndex].spd * spdMultiplier, enemy.y + enemyDir[1] * enemyStats[enemyIndex].spd * spdMultiplier)
        if (game.runtime() - sprites.readDataNumber(enemy, "lastShot") > (1000/enemyStats[enemyIndex].frt)){
            sprites.setDataNumber(enemy, "lastShot", game.runtime())
            let bullet = sprites.createProjectile(enemyBulletImg, -70, 0, SpriteKind.EnemyProjectile)
            bullet.setPosition(enemy.x - 12, enemy.y)
        }
    }
}

game.onUpdate(function () {
    if (state != "playing") return
    let velocity = normalize(playerVelocity[0], playerVelocity[1])
    player.setPosition(Math.clamp(10, 150, player.x + velocity[0] * shipStats[selectIndex].spd * spdMultiplier), Math.clamp(10, 110, player.y + velocity[1] * shipStats[selectIndex].spd * spdMultiplier))
    updateEnemies()
    if (lastEnemySpawn + spawnRate < game.runtime() && activeEnemies.length < 4 && enemiesToSpawn-activeEnemies.length > 0) {
        activeEnemies.push(spawnEnemy())
        lastEnemySpawn = game.runtime()
    }
})